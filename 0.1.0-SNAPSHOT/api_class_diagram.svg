<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="560.4px" preserveAspectRatio="none" style="width:990px;height:560px;background:#FFFFFF;" version="1.1" viewBox="0 0 990 560" width="990.6px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="363" x="309.6" y="15.0645">Calypsonet - calypsonet-terminal-calypso-crypto-symmetric-java-api - 0.1.+ (2022-11-29)</text><!--MD5=[7442f3b126ee602ae02566c1a49e158a]
cluster api--><g id="cluster_api"><path d="M5.1,27.3809 L212.7,27.3809 A2.25,2.25 0 0 1 214.2,28.8809 L218.4,42.1535 L984.9,42.1535 A1.5,1.5 0 0 1 986.4,43.6535 L986.4,555.0809 A1.5,1.5 0 0 1 984.9,556.5809 L5.1,556.5809 A1.5,1.5 0 0 1 3.6,555.0809 L3.6,28.8809 A1.5,1.5 0 0 1 5.1,27.3809 " fill="#F8F9F9" style="stroke:#000000;stroke-width:0.8999999999999999;"/><line style="stroke:#000000;stroke-width:0.8999999999999999;" x1="3.6" x2="218.4" y1="42.1535" y2="42.1535"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="207" x="6" y="37.6453">org.calypsonet.terminal.calypso.crypto.symmetric</text></g><!--MD5=[f7e0e2453c87923036c1ac2adfb9cbf0]
cluster spi--><g id="cluster_spi"><path d="M339.9,54.3809 L353.1,54.3809 A2.25,2.25 0 0 1 354.6,55.8809 L358.8,69.1535 L970.5,69.1535 A1.5,1.5 0 0 1 972,70.6535 L972,446.4809 A1.5,1.5 0 0 1 970.5,447.9809 L339.9,447.9809 A1.5,1.5 0 0 1 338.4,446.4809 L338.4,55.8809 A1.5,1.5 0 0 1 339.9,54.3809 " fill="#F2F3F4" style="stroke:#000000;stroke-width:0.8999999999999999;"/><line style="stroke:#000000;stroke-width:0.8999999999999999;" x1="338.4" x2="358.8" y1="69.1535" y2="69.1535"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-weight="bold" lengthAdjust="spacing" textLength="12.6" x="340.8" y="64.6453">spi</text></g><!--MD5=[ed6cd72910c1e7c5421683689620b946]
class SymmetricCryptoException--><g id="elem_SymmetricCryptoException"><rect codeLine="147" fill="#F4ECF7" height="60.2906" id="SymmetricCryptoException" rx="1.5" ry="1.5" style="stroke:#8E44AD;stroke-width:1.2;" width="253.2" x="388.2" y="486.9809"/><ellipse cx="458.55" cy="501.1535" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M459.1219,499.1379 L459.1219,503.1316 L460.1531,503.1316 Q460.5188,503.1316 460.6781,503.2723 Q460.8375,503.4129 460.8375,503.6473 Q460.8375,503.8723 460.6781,504.0129 Q460.5188,504.1535 460.1531,504.1535 L457.0687,504.1535 Q456.7031,504.1535 456.5438,504.0129 Q456.3844,503.8723 456.3844,503.6379 Q456.3844,503.4129 456.5438,503.2723 Q456.7031,503.1316 457.0687,503.1316 L458.1,503.1316 L458.1,499.1379 L457.0687,499.1379 Q456.7031,499.1379 456.5438,498.9973 Q456.3844,498.8566 456.3844,498.6223 Q456.3844,498.3973 456.5438,498.2566 Q456.7031,498.116 457.0687,498.116 L460.1531,498.116 Q460.5188,498.116 460.6781,498.2566 Q460.8375,498.3973 460.8375,498.6223 Q460.8375,498.8566 460.6781,498.9973 Q460.5188,499.1379 460.1531,499.1379 L459.1219,499.1379 Z " fill="#000000"/><ellipse cx="473.85" cy="500.8535" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="46.2" x="504.75" y="499.0453">«Exception»</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="100.8" x="477.45" y="510.218">SymmetricCryptoException</text><line style="stroke:#8E44AD;stroke-width:1.2;" x1="388.8" x2="640.8" y1="515.3262" y2="515.3262"/><line style="stroke:#8E44AD;stroke-width:1.2;" x1="388.8" x2="640.8" y1="520.1262" y2="520.1262"/><ellipse cx="394.8" cy="529.0125" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="168" x="400.2" y="531.5906">SymmetricCryptoException (String message)</text><ellipse cx="394.8" cy="540.1852" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="237.6" x="400.2" y="542.7633">SymmetricCryptoException (String message, Throwable cause)</text></g><!--MD5=[dc78e81cea955f8614ec1504e52d6421]
class SymmetricCryptoIOException--><g id="elem_SymmetricCryptoIOException"><rect codeLine="148" fill="#F4ECF7" height="60.2906" id="SymmetricCryptoIOException" rx="1.5" ry="1.5" style="stroke:#8E44AD;stroke-width:1.2;" width="261.6" x="662.4" y="486.9809"/><ellipse cx="732.45" cy="501.1535" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M733.0219,499.1379 L733.0219,503.1316 L734.0531,503.1316 Q734.4187,503.1316 734.5781,503.2723 Q734.7375,503.4129 734.7375,503.6473 Q734.7375,503.8723 734.5781,504.0129 Q734.4187,504.1535 734.0531,504.1535 L730.9688,504.1535 Q730.6031,504.1535 730.4438,504.0129 Q730.2844,503.8723 730.2844,503.6379 Q730.2844,503.4129 730.4438,503.2723 Q730.6031,503.1316 730.9688,503.1316 L732,503.1316 L732,499.1379 L730.9688,499.1379 Q730.6031,499.1379 730.4438,498.9973 Q730.2844,498.8566 730.2844,498.6223 Q730.2844,498.3973 730.4438,498.2566 Q730.6031,498.116 730.9688,498.116 L734.0531,498.116 Q734.4187,498.116 734.5781,498.2566 Q734.7375,498.3973 734.7375,498.6223 Q734.7375,498.8566 734.5781,498.9973 Q734.4187,499.1379 734.0531,499.1379 L733.0219,499.1379 Z " fill="#000000"/><ellipse cx="747.75" cy="500.8535" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="46.2" x="783.15" y="499.0453">«Exception»</text><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="109.8" x="751.35" y="510.218">SymmetricCryptoIOException</text><line style="stroke:#8E44AD;stroke-width:1.2;" x1="663" x2="923.4" y1="515.3262" y2="515.3262"/><line style="stroke:#8E44AD;stroke-width:1.2;" x1="663" x2="923.4" y1="520.1262" y2="520.1262"/><ellipse cx="669" cy="529.0125" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="176.4" x="674.4" y="531.5906">SymmetricCryptoIOException (String message)</text><ellipse cx="669" cy="540.1852" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="246" x="674.4" y="542.7633">SymmetricCryptoIOException (String message, Throwable cause)</text></g><!--MD5=[b603a74dfece547939852eca9002246b]
class SvCommandSecurityDataApi--><g id="elem_SvCommandSecurityDataApi"><rect codeLine="146" fill="#F4ECF7" height="118.1812" id="SvCommandSecurityDataApi" rx="1.5" ry="1.5" style="stroke:#8E44AD;stroke-width:1.2;" width="315.6" x="13.2" y="253.2809"/><ellipse cx="111.15" cy="262.8809" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M111.7219,260.8652 L111.7219,264.859 L112.7531,264.859 Q113.1187,264.859 113.2781,264.9996 Q113.4375,265.1402 113.4375,265.3746 Q113.4375,265.5996 113.2781,265.7402 Q113.1187,265.8809 112.7531,265.8809 L109.6688,265.8809 Q109.3031,265.8809 109.1438,265.7402 Q108.9844,265.5996 108.9844,265.3652 Q108.9844,265.1402 109.1438,264.9996 Q109.3031,264.859 109.6688,264.859 L110.7,264.859 L110.7,260.8652 L109.6688,260.8652 Q109.3031,260.8652 109.1438,260.7246 Q108.9844,260.584 108.9844,260.3496 Q108.9844,260.1246 109.1438,259.984 Q109.3031,259.8434 109.6688,259.8434 L112.7531,259.8434 Q113.1187,259.8434 113.2781,259.984 Q113.4375,260.1246 113.4375,260.3496 Q113.4375,260.584 113.2781,260.7246 Q113.1187,260.8652 112.7531,260.8652 L111.7219,260.8652 Z " fill="#000000"/><ellipse cx="126.45" cy="262.5809" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="108" x="130.05" y="266.359">SvCommandSecurityDataApi</text><line style="stroke:#8E44AD;stroke-width:1.2;" x1="13.8" x2="328.2" y1="272.4809" y2="272.4809"/><line style="stroke:#8E44AD;stroke-width:1.2;" x1="13.8" x2="328.2" y1="277.2809" y2="277.2809"/><ellipse cx="19.8" cy="286.1672" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="99" x="25.2" y="288.7453">byte[] getSvGetRequest ()</text><ellipse cx="19.8" cy="297.3398" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="105.6" x="25.2" y="299.918">byte[] getSvGetResponse ()</text><ellipse cx="19.8" cy="308.5125" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="147.6" x="25.2" y="311.0906">byte[] getSvCommandPartialRequest ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="25.2" y="322.2633"> </text><ellipse cx="19.8" cy="330.8578" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="255" x="25.2" y="333.4359">SvCommandSecurityDataApi setSerialNumber (byte[] serialNumber)</text><ellipse cx="19.8" cy="342.0305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="300" x="25.2" y="344.6086">SvCommandSecurityDataApi setTransactionNumber (byte[] transactionNumber)</text><ellipse cx="19.8" cy="353.2031" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="294" x="25.2" y="355.7813">SvCommandSecurityDataApi setTerminalChallenge (byte[] terminalChallenge)</text><ellipse cx="19.8" cy="364.3758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="267.6" x="25.2" y="366.9539">SvCommandSecurityDataApi setTerminalSvMac (byte[] terminalSvMac)</text></g><!--MD5=[bb3fae334104f06ba0a4414ece7963c2]
class SymmetricCryptoTransactionManagerFactorySpi--><g id="elem_SymmetricCryptoTransactionManagerFactorySpi"><rect codeLine="55" fill="#FEFECE" height="62.318" id="SymmetricCryptoTransactionManagerFactorySpi" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="614.4" x="348" y="76.5809"/><ellipse cx="557.25" cy="86.1809" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M557.8219,84.1652 L557.8219,88.159 L558.8531,88.159 Q559.2188,88.159 559.3781,88.2996 Q559.5375,88.4402 559.5375,88.6746 Q559.5375,88.8996 559.3781,89.0402 Q559.2188,89.1809 558.8531,89.1809 L555.7688,89.1809 Q555.4031,89.1809 555.2438,89.0402 Q555.0844,88.8996 555.0844,88.6652 Q555.0844,88.4402 555.2438,88.2996 Q555.4031,88.159 555.7688,88.159 L556.8,88.159 L556.8,84.1652 L555.7688,84.1652 Q555.4031,84.1652 555.2438,84.0246 Q555.0844,83.884 555.0844,83.6496 Q555.0844,83.4246 555.2438,83.284 Q555.4031,83.1434 555.7688,83.1434 L558.8531,83.1434 Q559.2188,83.1434 559.3781,83.284 Q559.5375,83.4246 559.5375,83.6496 Q559.5375,83.884 559.3781,84.0246 Q559.2188,84.1652 558.8531,84.1652 L557.8219,84.1652 Z " fill="#000000"/><ellipse cx="572.55" cy="85.8809" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="184.2" x="576.15" y="89.659">SymmetricCryptoTransactionManagerFactorySpi</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="348.6" x2="961.8" y1="95.7809" y2="95.7809"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="348.6" x2="961.8" y1="100.5809" y2="100.5809"/><ellipse cx="354.6" cy="109.4672" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="143.4" x="360" y="112.0453">boolean isExtendedModeSupported ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="360" y="123.218"> </text><ellipse cx="354.6" cy="131.8125" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="598.8" x="360" y="134.3906">SymmetricCryptoTransactionManagerSpi createTransactionManager (byte[] cardKeyDiversifier, boolean useExtendedMode, List&lt;byte[]&gt; transactionAuditData)</text></g><!--MD5=[1faf4190d52f0dec5aa33ffdfed48092]
class SymmetricCryptoTransactionManagerSpi--><g id="elem_SymmetricCryptoTransactionManagerSpi"><rect codeLine="60" fill="#FEFECE" height="252.2531" id="SymmetricCryptoTransactionManagerSpi" rx="1.5" ry="1.5" style="stroke:#D4AC0D;stroke-width:1.2;" width="516" x="378" y="186.3809"/><ellipse cx="552.45" cy="195.9809" fill="#B4A7E5" rx="6.6" ry="6.6" style="stroke:#181818;stroke-width:0.6;"/><path d="M553.0219,193.9652 L553.0219,197.959 L554.0531,197.959 Q554.4187,197.959 554.5781,198.0996 Q554.7375,198.2402 554.7375,198.4746 Q554.7375,198.6996 554.5781,198.8402 Q554.4187,198.9809 554.0531,198.9809 L550.9688,198.9809 Q550.6031,198.9809 550.4438,198.8402 Q550.2844,198.6996 550.2844,198.4652 Q550.2844,198.2402 550.4438,198.0996 Q550.6031,197.959 550.9688,197.959 L552,197.959 L552,193.9652 L550.9688,193.9652 Q550.6031,193.9652 550.4438,193.8246 Q550.2844,193.684 550.2844,193.4496 Q550.2844,193.2246 550.4438,193.084 Q550.6031,192.9434 550.9688,192.9434 L554.0531,192.9434 Q554.4187,192.9434 554.5781,193.084 Q554.7375,193.2246 554.7375,193.4496 Q554.7375,193.684 554.5781,193.8246 Q554.4187,193.9652 554.0531,193.9652 L553.0219,193.9652 Z " fill="#000000"/><ellipse cx="567.75" cy="195.6809" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" font-style="italic" lengthAdjust="spacing" textLength="155.4" x="571.35" y="199.459">SymmetricCryptoTransactionManagerSpi</text><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="378.6" x2="893.4" y1="205.5809" y2="205.5809"/><line style="stroke:#D4AC0D;stroke-width:1.2;" x1="378.6" x2="893.4" y1="210.3809" y2="210.3809"/><ellipse cx="384.6" cy="219.2672" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="134.4" x="390" y="221.8453">byte[] initTerminalSessionContext ()</text><ellipse cx="384.6" cy="230.4398" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="315" x="390" y="233.018">void initTerminalSessionMac (byte[] openSecureSessionDataOut, byte kif, byte kvc)</text><ellipse cx="384.6" cy="241.6125" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="196.8" x="390" y="244.1906">byte[] updateTerminalSessionMac (byte[] cardApdu)</text><ellipse cx="384.6" cy="252.7852" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="136.2" x="390" y="255.3633">byte[] finalizeTerminalSessionMac ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="390" y="266.5359"> </text><ellipse cx="384.6" cy="275.1305" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="144.6" x="390" y="277.7086">byte[] generateTerminalSessionMac ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="390" y="288.8812"> </text><ellipse cx="384.6" cy="297.4758" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="96" x="390" y="300.0539">void activateEncryption ()</text><ellipse cx="384.6" cy="308.6484" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="105.6" x="390" y="311.2266">void deactivateEncryption ()</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="390" y="322.3992"> </text><ellipse cx="384.6" cy="330.9938" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="216" x="390" y="333.5719">boolean isCardSessionMacValid (byte[] cardSessionMac)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="390" y="344.7445"> </text><ellipse cx="384.6" cy="353.3391" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="283.2" x="390" y="355.9172">void computeSvCommandSecurityData (SvCommandSecurityDataApi data)</text><ellipse cx="384.6" cy="364.5117" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="175.2" x="390" y="367.0898">boolean isCardSvMacValid (byte[] cardSvMac)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="390" y="378.2625"> </text><ellipse cx="384.6" cy="386.857" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="315.6" x="390" y="389.4352">byte[] cipherPinForPresentation (byte[] cardChallenge, byte[] pin, Byte kif, Byte kvc)</text><ellipse cx="384.6" cy="398.0297" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="395.4" x="390" y="400.6078">byte[] cipherPinForModification (byte[] cardChallenge, byte[] currentPin, byte[] newPin, Byte kif, Byte kvc)</text><ellipse cx="384.6" cy="409.2023" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="500.4" x="390" y="411.7805">byte[] generateCipheredCardKey (byte[] cardChallenge, byte issuerKeyKif, byte issuerKeyKvc, byte targetKeyKif, byte targetKeyKvc)</text><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="2.4" x="390" y="422.9531"> </text><ellipse cx="384.6" cy="431.5477" fill="#84BE84" rx="1.8" ry="1.8" style="stroke:#038048;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacing" textLength="71.4" x="390" y="434.1258">void synchronize ()</text></g><!--MD5=[de96a5dbaa5c5ef9677e1bc26a5a7473]
link SymmetricCryptoTransactionManagerFactorySpi to SymmetricCryptoTransactionManagerSpi--><g id="link_SymmetricCryptoTransactionManagerFactorySpi_SymmetricCryptoTransactionManagerSpi"><path codeLine="132" d="M652.302,139.0523 C651.126,151.5371 649.68,166.8749 648.138,183.2087 " fill="none" id="SymmetricCryptoTransactionManagerFactorySpi-to-SymmetricCryptoTransactionManagerSpi" style="stroke:#3498DB;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#3498DB" points="647.85,186.2693,650.7462,181.1183,648.1316,183.2825,645.9674,180.6678,647.85,186.2693" style="stroke:#3498DB;stroke-width:1.2;"/><polygon fill="#000000" points="653.1183,165.7549,655.3834,160.5174,651.8723,160.1863,653.1183,165.7549" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="24" x="658.8" y="165.9979">provide</text></g><!--MD5=[7e5f7722ad5fb9718b512270be165506]
reverse link SvCommandSecurityDataApi to SymmetricCryptoTransactionManagerSpi--><g id="link_SvCommandSecurityDataApi_SymmetricCryptoTransactionManagerSpi"><path codeLine="134" d="M332.0952,312.3809 C347.0322,312.3809 362.4054,312.3809 377.9316,312.3809 " fill="none" id="SvCommandSecurityDataApi-backto-SymmetricCryptoTransactionManagerSpi" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="328.9146,312.3809,334.3146,314.7809,331.9146,312.3809,334.3146,309.9809,328.9146,312.3809" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="342.6,304.9682,348.0271,306.7315,348.0271,303.2048,342.6,304.9682" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="12.6" x="351" y="308.1979">use</text></g><!--MD5=[20df3513a866a92a4fec23a94209879e]
link SymmetricCryptoTransactionManagerSpi to SymmetricCryptoException--><g id="link_SymmetricCryptoTransactionManagerSpi_SymmetricCryptoException"><path codeLine="136" d="M561.1392,438.6137 C551.1636,455.3549 541.734,471.1793 534.018,484.1285 " fill="none" id="SymmetricCryptoTransactionManagerSpi-to-SymmetricCryptoException" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="532.398,486.8471,537.2241,483.4369,533.9338,484.27,533.1008,480.9797,532.398,486.8471" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="548.6643,465.9453,552.9572,462.1858,549.9276,460.3806,548.6643,465.9453" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="22.8" x="555.6" y="466.5979">throws</text></g><!--MD5=[5a9de831ed687af60f8ef6770f3cfd28]
link SymmetricCryptoTransactionManagerSpi to SymmetricCryptoIOException--><g id="link_SymmetricCryptoTransactionManagerSpi_SymmetricCryptoIOException"><path codeLine="137" d="M733.098,438.6137 C746.142,455.4953 758.472,471.4445 768.522,484.4531 " fill="none" id="SymmetricCryptoTransactionManagerSpi-to-SymmetricCryptoIOException" style="stroke:#27AE60;stroke-width:1.2;stroke-dasharray:7.0,7.0;"/><polygon fill="#27AE60" points="770.376,486.8471,768.9638,481.109,768.5377,484.4762,765.1705,484.0502,770.376,486.8471" style="stroke:#27AE60;stroke-width:1.2;"/><polygon fill="#000000" points="759.6344,465.742,757.7112,460.3695,754.9206,462.526,759.6344,465.742" style="stroke:#000000;stroke-width:0.6;"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacing" textLength="22.8" x="763.2" y="466.5979">throws</text></g><!--MD5=[1264b93fced0e82db97393e6569603b1]
@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-symmetric-java-api - 0.1.+ (2022-11-29)
end title

' == THEME ==

'Couleurs issues de : https://htmlcolorcodes.com/fr/tableau-de-couleur/tableau-de-couleur-design-plat/
!define C_GREY1 F8F9F9
!define C_GREY2 F2F3F4
!define C_GREY3 E5E7E9
!define C_GREY4 D7DBDD
!define C_GREY5 CACFD2
!define C_GREY6 BDC3C7
!define C_LINK 3498DB
!define C_USE 27AE60

' - - Styles that don't work with new version of plantuml - -
skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF
' - - END - -

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

' Yellow
skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
' Red
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
' Purple
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
' blue
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
' Green
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
' Grey
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype

' == CONTENT ==

package "org.calypsonet.terminal.calypso.crypto.symmetric" as api {
    package spi {
        +interface SymmetricCryptoTransactionManagerFactorySpi {
            +boolean isExtendedModeSupported ()
    
            +SymmetricCryptoTransactionManagerSpi createTransactionManager (byte[] cardKeyDiversifier, boolean useExtendedMode, List<byte[]> transactionAuditData)
        }
        +interface SymmetricCryptoTransactionManagerSpi {
            +byte[] initTerminalSessionContext ()
            +void initTerminalSessionMac (byte[] openSecureSessionDataOut, byte kif, byte kvc)
            +byte[] updateTerminalSessionMac (byte[] cardApdu)
            +byte[] finalizeTerminalSessionMac ()
    
            +byte[] generateTerminalSessionMac ()
    
            +void activateEncryption ()
            +void deactivateEncryption ()
    
            +boolean isCardSessionMacValid (byte[] cardSessionMac)
    
            +void computeSvCommandSecurityData (SvCommandSecurityDataApi data)
            +boolean isCardSvMacValid (byte[] cardSvMac)
    
            +byte[] cipherPinForPresentation (byte[] cardChallenge, byte[] pin, Byte kif, Byte kvc)
            +byte[] cipherPinForModification (byte[] cardChallenge, byte[] currentPin, byte[] newPin, Byte kif, Byte kvc)
            +byte[] generateCipheredCardKey (byte[] cardChallenge, byte issuerKeyKif, byte issuerKeyKvc, byte targetKeyKif, byte targetKeyKvc)

            +void synchronize ()
        }
    }
    +class "<<Exception>>\nSymmetricCryptoException" as SymmetricCryptoException {
        +SymmetricCryptoException (String message)
        +SymmetricCryptoException (String message, Throwable cause)
    }
    +class "<<Exception>>\nSymmetricCryptoIOException" as SymmetricCryptoIOException {
        +SymmetricCryptoIOException (String message)
        +SymmetricCryptoIOException (String message, Throwable cause)
    }
    +interface SvCommandSecurityDataApi {
        +byte[] getSvGetRequest ()
        +byte[] getSvGetResponse ()
        +byte[] getSvCommandPartialRequest ()

        +SvCommandSecurityDataApi setSerialNumber (byte[] serialNumber)
        +SvCommandSecurityDataApi setTransactionNumber (byte[] transactionNumber)
        +SvCommandSecurityDataApi setTerminalChallenge (byte[] terminalChallenge)
        +SvCommandSecurityDataApi setTerminalSvMac (byte[] terminalSvMac)
    }

'
'    +interface SymmetricCryptoTransactionManagerFactorySpiDesignByUseCase {
'        +byte[] initTerminalSecureSessionContext (byte[] keyDiversifier)
'
'        +byte[] computeTerminalSessionMac (byte[] openSecureSessionDataOut, byte kif, byte kvc, List<byte[]> cardApdus)
'        +void initTerminalSessionMac (byte[] openSecureSessionDataOut, byte kif, byte kvc)
'        +void initTerminalSessionMac (byte[] openSecureSessionDataOut, byte kif, byte kvc, List<byte[]> cardApdus)
'        +void updateTerminalSessionMac (List<byte[]> cardApdus)
'        +byte[] updateTerminalSessionMacEncrypted (byte[] cardApdu)
'        +byte[] finalizeTerminalSessionMac (List<byte[]> cardApdus)
'        +byte[] finalizeTerminalSessionMac ()
'
'        +<s>byte[] generateTerminalSessionMac ()
'
'        +boolean verifyCardSessionMac (byte[] cardSessionMac)
'
'        +void generateSvCommandSecurityData (SvCommandSecurityDataApi SvCommandSecurityDataApi)
'        +void generateSvCommandSecurityData (byte[] cardSerial, SvCommandSecurityDataApi SvCommandSecurityDataApi)
'        +boolean verifyCardSvMac (byte[] cardSvMac)
'        +boolean verifyCardSessionAndSvMac (byte[] cardSessionMac, byte[] cardSvMac)
'
'        +byte[] cipherPinForPresentation (byte[] openSecureSessionDataOut, byte kif, byte kvc, List<byte[]> cardApdus, byte[] cardSerial, byte[] cardChallenge, byte[] pin, byte kif, byte kvc)
'        +byte[] cipherPinForPresentation (byte[] cardSerial, byte[] cardChallenge, byte[] pin, byte kif, byte kvc)
'        +byte[] cipherPinForModification (byte[] cardSerial, byte[] cardChallenge, byte[] currentPin, byte[] newPin, byte kif, byte kvc)
'        +byte[] generateCardKey (byte[] cardSerial, byte[] cardChallenge, byte issuerKeyKif, byte issuerKeyKvc, byte targetKeyKif, byte targetKeyKvc)
'    }
}

' Associations

SymmetricCryptoTransactionManagerFactorySpi ..> SymmetricCryptoTransactionManagerSpi #C_LINK : provide >

SymmetricCryptoTransactionManagerSpi .left.> SvCommandSecurityDataApi #C_USE : use >

SymmetricCryptoTransactionManagerSpi ..> SymmetricCryptoException #C_USE : throws >
SymmetricCryptoTransactionManagerSpi ..> SymmetricCryptoIOException #C_USE : throws >

' == LAYOUT ==

' == STYLE ==

package api #C_GREY1 {}
package spi #C_GREY2 {}

interface SvCommandSecurityDataApi <<purple>>
interface SymmetricCryptoException <<purple>>
interface SymmetricCryptoIOException <<purple>>

@enduml

@startuml
title
    Calypsonet - calypsonet-terminal-calypso-crypto-symmetric-java-api - 0.1.+ (2022-11-29)
end title



skinparam stereotypeABorderColor #A9DCDF
skinparam stereotypeIBorderColor #B4A7E5
skinparam stereotypeCBorderColor #ADD1B2
skinparam stereotypeEBorderColor #EB93DF

skinparam ClassBorderThickness 2
skinparam ArrowThickness 2

skinparam ClassBackgroundColor #FEFECE
skinparam ClassBorderColor #D4AC0D
skinparam ClassBackgroundColor<<red>> #FDEDEC
skinparam ClassBorderColor<<red>> #E74C3C
hide <<red>> stereotype
skinparam ClassBackgroundColor<<purple>> #F4ECF7
skinparam ClassBorderColor<<purple>> #8E44AD
hide <<purple>> stereotype
skinparam ClassBackgroundColor<<blue>> #EBF5FB
skinparam ClassBorderColor<<blue>> #3498DB
hide <<blue>> stereotype
skinparam ClassBackgroundColor<<green>> #E9F7EF
skinparam ClassBorderColor<<green>> #27AE60
hide <<green>> stereotype
skinparam ClassBackgroundColor<<grey>> #EAECEE
skinparam ClassBorderColor<<grey>> #2C3E50
hide <<grey>> stereotype


package "org.calypsonet.terminal.calypso.crypto.symmetric" as api {
    package spi {
        +interface SymmetricCryptoTransactionManagerFactorySpi {
            +boolean isExtendedModeSupported ()
    
            +SymmetricCryptoTransactionManagerSpi createTransactionManager (byte[] cardKeyDiversifier, boolean useExtendedMode, List<byte[]> transactionAuditData)
        }
        +interface SymmetricCryptoTransactionManagerSpi {
            +byte[] initTerminalSessionContext ()
            +void initTerminalSessionMac (byte[] openSecureSessionDataOut, byte kif, byte kvc)
            +byte[] updateTerminalSessionMac (byte[] cardApdu)
            +byte[] finalizeTerminalSessionMac ()
    
            +byte[] generateTerminalSessionMac ()
    
            +void activateEncryption ()
            +void deactivateEncryption ()
    
            +boolean isCardSessionMacValid (byte[] cardSessionMac)
    
            +void computeSvCommandSecurityData (SvCommandSecurityDataApi data)
            +boolean isCardSvMacValid (byte[] cardSvMac)
    
            +byte[] cipherPinForPresentation (byte[] cardChallenge, byte[] pin, Byte kif, Byte kvc)
            +byte[] cipherPinForModification (byte[] cardChallenge, byte[] currentPin, byte[] newPin, Byte kif, Byte kvc)
            +byte[] generateCipheredCardKey (byte[] cardChallenge, byte issuerKeyKif, byte issuerKeyKvc, byte targetKeyKif, byte targetKeyKvc)

            +void synchronize ()
        }
    }
    +class "<<Exception>>\nSymmetricCryptoException" as SymmetricCryptoException {
        +SymmetricCryptoException (String message)
        +SymmetricCryptoException (String message, Throwable cause)
    }
    +class "<<Exception>>\nSymmetricCryptoIOException" as SymmetricCryptoIOException {
        +SymmetricCryptoIOException (String message)
        +SymmetricCryptoIOException (String message, Throwable cause)
    }
    +interface SvCommandSecurityDataApi {
        +byte[] getSvGetRequest ()
        +byte[] getSvGetResponse ()
        +byte[] getSvCommandPartialRequest ()

        +SvCommandSecurityDataApi setSerialNumber (byte[] serialNumber)
        +SvCommandSecurityDataApi setTransactionNumber (byte[] transactionNumber)
        +SvCommandSecurityDataApi setTerminalChallenge (byte[] terminalChallenge)
        +SvCommandSecurityDataApi setTerminalSvMac (byte[] terminalSvMac)
    }

}


SymmetricCryptoTransactionManagerFactorySpi ..> SymmetricCryptoTransactionManagerSpi #3498DB : provide >

SymmetricCryptoTransactionManagerSpi .left.> SvCommandSecurityDataApi #27AE60 : use >

SymmetricCryptoTransactionManagerSpi ..> SymmetricCryptoException #27AE60 : throws >
SymmetricCryptoTransactionManagerSpi ..> SymmetricCryptoIOException #27AE60 : throws >



package api #F8F9F9 {}
package spi #F2F3F4 {}

interface SvCommandSecurityDataApi <<purple>>
interface SymmetricCryptoException <<purple>>
interface SymmetricCryptoIOException <<purple>>

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: fr
Country: FR
--></g></svg>